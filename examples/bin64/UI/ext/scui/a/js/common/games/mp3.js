define("common/games/mp3",["jquery","common/xhr","utils","setup.environment","setup.environment.utils","common/datafunctions","common/modals/modal-views","common/games/gamecommon"],function(t,e,a,s,n,o,l,r){var i={},d="156950352,-2103486802",m=",1500719206,1570571613",u=",528536644,741286365",c=",982169050,222726850",p=",1347617716,-1857458609,997965532,779599105,1133504003,-2103486802,-1932771401,-2103486802";return i.statIds=d+m+u+c+p,i.LoadHomeScreen=function(){n.isOnline()&&i.GetCommunityStatsJS(),n.isOnline()&&n.isSignedIn()&&!n.isLocal()&&t("#homefeedPanel").find(".contentWrapper").fadeOut("slow"),r.LoadHomeScreen()},i.GetCommunityStatsJS=function(){var t={env:globals.rosEnvironment,title:globals.titleName,version:globals.RosTitleVersion,platformId:globals.platformId,rosTitleName:globals.titleName,statIds:i.statIds};a.WriteDebugLog("GetCommunityStatsJS","options",JSON.stringify(t)),e.ajax({type:"POST",url:a.getApiUrl("/api/"+globals.titleName+"/getcommunitystats"),services:["stats"],data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",silentFail:!0,disableSlowMsg:!0,requestDescription:"GetCommunityStats",success:function(t){"undefined"!=typeof t&&null!=t&&void 0!=t.d&&t.Status?i.ProcessCommunityStats(t):i.GetCommunityStatsJSLocal()},error:function(t,e,s){a.WriteDebugLog("GetCommunityStatsJS","ERROR",s),a.WriteDebugLog("GetCommunityStatsJS","ERROR status",e),a.WriteDebugLog("GetCommunityStatsJS","ERROR responseText",t.responseText,a.logType.error,a.logController[globals.titleName]),i.GetCommunityStatsJSLocal()}})},i.GetCommunityStatsJSLocal=function(){a.WriteDebugLog("GetCommunityStatsJSLocal","",""),e.ajax({type:"GET",url:globals.baseAssetUrl+"xml/"+globals.titleName+"/CommunityStats.xml",dataType:"json",success:function(t){i.ProcessCommunityStats(t)},error:function(e,s,n){a.WriteDebugLog("GetCommunityStatsJSLocal","ERROR",n,a.logType.error,a.logController[globals.titleName]);try{t(this).stopPropagation()}catch(o){}}})},i.ProcessCommunityStats=function(e){if("undefined"!=typeof e&&null!=e&&"undefined"!=e.d&&(a.WriteDebugLog("ProcessCommunityStats","data.d",e.d),"ERROR"!=e.d.substring(0,5).toUpperCase())){var s=e.d.split(","),n=t("#homefeedPanel"),o=parseInt(s[0],10)+parseInt(s[1],10);n.find("#trendStatDWKills").html(a.addCommas(o)),n.find("#trendStatBulletsFired").html(i.formatTrendStat(a.addCommas(parseInt(s[2],10)+parseInt(s[3],10)))),n.find("#trendStatPillsPopped").html(i.formatTrendStat(a.addCommas(parseInt(s[4],10)+parseInt(s[5],10)))),n.find("#trendStatShootDodgeKills").html(i.formatTrendStat(a.addCommas(parseInt(s[6],10)+parseInt(s[7],10))));for(var l=0,r=8;r<s.length;r++)l+=parseInt(s[r],10);n.find("#trendStat2HKills").html(a.addCommas(l)),n.find("#globalStats").find("div.skull").removeClass("left right middle"),n.find("#globalStats").find("div.skull").addClass(o>1.2*l?"left":l>1.2*o?"right":"middle"),("undefined"!=typeof s[s.length-1]||null!=s[s.length-1])&&n.find("#statsDate").html(a.localizedDate(s[s.length-1],"LLL"))}},i.formatTrendStat=function(t){var e=t.split(",");if(e.length>1){for(var a="<span>"+e[0]+"</span>",s=1;s<e.length;s++)a+=","+e[s];return a}return t},i.LoadPlayerStats=function(s){a.WriteDebugLog("LoadPlayerStats","compareRockstarId",s),e.ajax({type:"GET",async:!1,url:globals.baseAssetUrl+"xml/"+globals.titleName+"/Stats"+globals.titlelang+".xml",dataType:"xml",success:function(e){var a=[];t(e).find("id").each(function(){a.push(t(this).text())}),i.GetPlayerStatsJS(e,a.join(","),globals.account.RockstarId,s),e=null,a=null},complete:function(t,e){a.ToggleCompareFriendElements(e)}})},i.GetPlayerStatsJS=function(s,o,r,i){var d=n.getCredsAsync();d.done(function(d){if(d&&d.Ticket){var m='{ "env":"'+globals.rosEnvironment+'","title":"'+globals.titleName+'","version":'+globals.RosTitleVersion+', "wsURL":"'+globals.wsURL+'","platformId":'+globals.platformId+',"statIds":"'+o+'","rockstarIds":"'+r+(void 0!=i?","+i:"")+'" }';a.WriteDebugLog("GetPlayerStatsJS","options",m);var u=n.GetAuthHeaderAsync(d.Ticket);u.done(function(d){e.ajax({type:"POST",url:a.getApiUrl("api/"+globals.titleName+"/getplayerstatsws"),services:["stats"],headers:d,data:m,contentType:"application/json; charset=utf-8",dataType:"xml",cache:!1,fatalError:l.ShowErrorModal,requestDescription:"GetPlayerStats",success:function(e,o){if("success"==o)if("true"==t(e).find("Status").text()){var l,d,m=2;null!=i&&void 0!=i&&(t("#statsPanel").addClass("compared"),m=3);var u=t(e).find("StatsRecord");u.each(function(){t(this).find("GamerHandle").text()=="SC "+r?l=t(this).find("Values").text().split(","):d=t(this).find("Values").text().split(",")});var c=[],p="";t(s).find("id").each(function(e){var s=t(this),n=s.parent().parent().find("header_name");n.length>0&&n.text()!=p&&(p=n.text(),c.length>0&&c.push("</tbody>"),c.push("<tbody id='"+n.nodeName+"' class='statgroup'><tr class='levelName statGroupHeader'><td colspan='"+m+"' class='levelName "+s.parent().parent()[0].nodeName+"'><span></span>"+p+"</td></tr>"));var o=s.text();if(""!=o.length){var r=void 0!=l&&void 0!=l[e]?l[e]:"0",i="",u=(s.parent()[0].nodeName.toUpperCase(),s.parent().find("type"));switch(u.text().toLowerCase()){case"duration":r="0"==r?"-":a.msToTime(r),t("#statsPanel").hasClass("compared")&&(i="<td class='col3'>"+(void 0!=d&&void 0!=d[e]&&"0"!=d[e]?a.msToTime(d[e]):"-")+"</td>");break;default:t("#statsPanel").hasClass("compared")&&(i="<td class='col3'>"+(void 0!=d&&void 0!=d[e]?d[e]:"0")+"</td>")}var g=s.parent().find("name");g.length>0&&c.push("<tr style='display:none' id='statId"+o+"' class='"+s.parent().parent()[0].nodeName+"'><td class='col1'>"+g.text()+"</td>"+i+"<td class='col2'>"+r+"</td></tr>")}}),c.length>0&&c.push("</tbody>"),t("#statstable").html(c.join("")),t("#statstable .statgroup").click(function(){var e=t(this);return e.find("tr.levelName.statGroupHeader").toggleClass("open"),e.children(":not(.statGroupHeader)").toggle("fast",function(){e.index()==e.parent().children().length-1&&n.resetScrollbar("#statsPanel")}),!1}),c=null,l=null,d=null}else a.WriteDebugLog("GetPlayerStatsJS","Status error",t(e).find("Error").text(),a.logType.error,a.logController[globals.titleName]);t("#checkName").fadeOut()},complete:function(){s=null,o=null,r=null,i=null,n.resetScrollbar("#statsContainer"),n.removeLoading("statsPanel"),t("#awardsLink2").removeClass("disabled")}})})}else n.removeLoading("statsPanel"),t("#statstable").html("<tr><td>"+n.getError("InternetAccess")+"</td></tr>")})},i});